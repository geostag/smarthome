[{"apiVersion":"influxdata.com/v2alpha1","kind":"Task","metadata":{"name":"serene-lichterman-986001"},"spec":{"every":"15m","name":"daily solar panel power","offset":"4m0s","query":"import \"date\"\n\n\n\nfrom(bucket: \"smarthome\")\n    |> range(start: today())\n    |> filter(\n        fn: (r) =>\n            r._measurement == \"zendure\" and (r._field == \"solarPower1\" or r._field == \"solarPower2\"\n                    or\n                    r._field == \"solarPower3\" or r._field == \"solarPower4\"),\n    )\n    |> aggregateWindow(\n        every: 1d,\n        fn: (column, tables=<-) => tables |> integral(unit: 1h),\n        createEmpty: false,\n    )\n    |> map(\n        fn: (r) =>\n            ({\n                _time: date.add(to: today(), d: 3h),\n                // 03:00 lokal (oder was du willst)\n                _measurement: \"daily_energy\",\n                _field: r._field,\n                // Field beibehalten\n                _value: r._value,\n            }),\n    )\n    |> to(bucket: \"smarthomederived\")"}}]